<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Insert/edit image</title>
        <link rel="stylesheet" type="text/css" href="skin/base.css" />
        <link rel="stylesheet" type="text/css" href="skin/widgets.css" />
        <link rel="stylesheet" type="text/css" href="skin/dialog.css" />
    </head>
    <body id="image"><div style="padding:10px">
        <h2>Insert/Edit image</h2>

        <div class="ui-upload" style="padding-bottom: 10px;">
            <span id="upload-components" style="display: none;"><button id="upload-file">Upload an image</button> or enter the details for an image already on the Web.</span>
            <div id="upload-drag"><!-- style="display: none;">-->
                <p>Upload an image by clicking the button below (or by dragging an image onto it), or you can enter the details for an image already on the Web in the form below.</p>
                <input type="file" id="sf_image_upload"/>
            </div>
            <div id="upload-working" style="display:none;">
                Uploading...
            </div>
        </div>

        <form id="sf_image_form">
            <div class="panel_wrapper">
                <div id="general_panel" class="current">
             <table border="0" cellpadding="4" cellspacing="0" style="width: 100%;">
                  <tr>
                    <td class="nowrap" style="width: 30%;"><label for="src">Image URL</label></td>
                    <td><table border="0" cellspacing="0" cellpadding="0" style="width: 100%;">
                        <tr>
                          <td><input id="sf_image_src" name="src" type="url" class="mceFocus" placeholder="http://"/></td>
                          <td id="srcbrowsercontainer">&nbsp;</td>
                        </tr>
                      </table></td>
                  </tr>
                  <tr>
                    <td><label for="sf_image_list">Image list</label></td>
                    <td><select id="sf_image_list" name="image_list"></select></td>
                  </tr>
                  <tr>
                    <td class="nowrap"><label for="alt">Image description</label></td>
                    <td><input id="alt" name="alt" type="text" value="" /></td>
                  </tr>
                  <tr>
                    <td class="nowrap"><label for="sf_image_align">Alignment</label></td>
                    <td>
                        <select id="sf_image_align" name="align">
                            <option value="">-- Not Set --</option>
                            <option value="baseline">Baseline</option>
                            <option value="top">Top</option>
                            <option value="middle">Middle</option>
                            <option value="bottom">Bottom</option>
                            <option value="text-top">Text top</option>
                            <option value="text-bottom">Text bottom</option>
                            <option value="left">Left</option>
                            <option value="right">Right</option>
                        </select>
                    </td>
                  </tr>
                  <tr>
                    <td class="nowrap"><label for="width">Dimensions</label></td>
                    <td><input id="sf_image_width" name="width" type="number" value="" size="5" maxlength="5" placeholder="w"/>
                      x
                      <input id="sf_image_height" name="height" type="number" value="" size="5" maxlength="5" placeholder="h"/></td>
                  </tr>
                  <tr>
                    <td class="nowrap"><label for="border">Border</label></td>
                    <td><input id="sf_image_border" name="border" type="number" value="" size="3" maxlength="3" placeholder="0"/></td>
                  </tr>
                </table>
                </div>
            </div>

            <input type="hidden" name="vspace"/>
            <input type="hidden" name="hspace"/>

            <div class="mceActionPanel">
                <a id="sf_image_cancel" class="cancel-button">Cancel</a>
                <button id="insert" name="insert">Insert</button>
            </div>
        </form>
        <!--
        <script>
            $(document).ready(function () {
                $("#upload-file").live("click", function (e) {
                    var button = $(this).addClass("busy");

                    e.preventDefault();

                    var nsIFilePicker = Components.interfaces.nsIFilePicker;
                    var fp = Components.classes["@mozilla.org/filepicker;1"].createInstance(nsIFilePicker);
                    fp.init(window, "Select an Image", nsIFilePicker.modeOpen);
                    var res = fp.show();

                    if (res == nsIFilePicker.returnOK){
                        var file = fp.file;

                        var fileInStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
                        fileInStream.init(file, 0x01, 0644, false);

                        var binaryInStream = Components.classes["@mozilla.org/binaryinputstream;1"] .createInstance(Components.interfaces.nsIBinaryInputStream);
                        binaryInStream.setInputStream(fileInStream);

                        var mimeSvc = Components.classes["@mozilla.org/mime;1"].getService(Components.interfaces.nsIMIMEService);

                        $("#insert").addClass("busy").text("Uploading...");

                        tinyMCEPopup.getWin().SCRIBEFIRE.getAPI().upload(
                            file.leafName,
                            mimeSvc.getTypeFromFile(file),
                            binaryInStream.readBytes(binaryInStream.available()),
                            function success (rv) {
                                $("#insert").removeClass("busy").text("Insert");

                                button.removeClass("busy");

                                $("#src").val(rv.url).change();
                            },
                            function (rv) {
                                $("#insert").removeClass("busy").text("Insert");

                                button.removeClass("busy");

                                tinyMCEPopup.getWin().SCRIBEFIRE.error("ScribeFire couldn't upload your file. Here's the error message that bubbled up:\n\n"+rv.msg);
                            },
                            file
                        );
                    }
                });
            });



        </script>-->

        <!--<script type="text/javascript" src="../../../../lib/platform.js"></script>
        <script type="text/javascript" src="../../../../scribefire.js"></script>
        <script type="text/javascript" src="../../tiny_mce_popup.js"></script>
        <script type="text/javascript" src="../../utils/mctabs.js"></script>
        <script type="text/javascript" src="../../utils/form_utils.js"></script>
        <script type="text/javascript" src="js/image.js"></script>
        <script type="text/javascript" src="../../../../vendor/jquery.js"></script>
        <script type="text/javascript" src="../../../../lib/upload.js"></script>-->
        <script type="text/javascript" src="vendor/jquery-1.8.3.js"></script>
        <script type="text/javascript" src="vendor/jquery-ui-1.9.2.custom.js"></script>
        <script type="text/javascript" src="vendor/jquery-resize.js"></script>
        <script type="text/javascript" src="lib/platform.js"></script>
        <script type="text/javascript" src="lib/i18n.js"></script>

        <script type="text/javascript" src="util.js"></script>
        <script type="text/javascript" src="xmlrpc.js"></script>
        <script type="text/javascript" src="apis.js"></script>
        <script type="text/javascript" src="scribefire.js"></script>
        <script type="text/javascript" src="vendor/parseUri.js"></script>
        <script type="text/javascript" src="vendor/tinymce/tinymce.min.js"></script>
        <!--<script type="text/javascript" src="vendor/tinymce/plugins/compat3x/tiny_mce_popup.js"></script>
        <script type="text/javascript" src="vendor/tinymce/plugins/compat3x/mctabs.js"></script>
        <script type="text/javascript" src="vendor/tinymce/plugins/compat3x/form_utils.js"></script>-->
        <script type="text/javascript" src="lib/persist.js"></script>
        <script type="text/javascript" src="lib/keyboard.js"></script>
        <script type="text/javascript" src="vendor/wordpress.js"></script>
        <script type="text/javascript" src="vendor/jquery-oembed.js"></script>
        <script type="text/javascript" src="lib/upload.js"></script>
        <script type="text/javascript" src="vendor/showdown.js"></script>
        <script type="text/javascript" src="vendor/jquery-paste-image-reader.js"></script>
        <script type="text/javascript" src="js/sf_image.js"></script>
    </div></body>
</html>